suite: basic
templates:
  - constraint.yaml
  - config.yaml
tests:
  - it: should work
    set:
      constraints:
        - kind: K8sRequiredAnnotations
          name: foobar
          parameters:
            annotations:
              - key: "foo"
                allowedRegex: "bar"
      exclude:
        - excludedNamespaces: ["kube-system", "gatekeeper-system"]
          processes: ["*"]
    asserts:
      - equal:
          path: metadata.name
          value: foobar
        template: constraint.yaml
      - equal:
          path: metadata.name
          value: config
        template: config.yaml
      - equal:
          path: spec.match[0].excludedNamespaces
          value: ["kube-system", "gatekeeper-system"]
        template: config.yaml
      - equal:
          path: spec.match[0].processes
          value: ["*"]
        template: config.yaml
